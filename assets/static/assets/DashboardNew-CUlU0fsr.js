import{j as e,F as W,u as G,a as R,b as E,c as I,d as V,e as j}from"./index-BpBXMnYt.js";import{r,u as q}from"./vendor-CoKE50sv.js";import{F as Q,a as X}from"./ChartBarIcon-DrjqaP5B.js";import{R as S,A as B,C as O,X as _,Y as L,T as $,a as M,P as Z,b as H,c as J}from"./charts-B-8BX82p.js";import{F as ee}from"./ClockIcon-DqX5lot2.js";import{F as te}from"./ArrowRightIcon-DPPo99DE.js";function se({title:s,titleId:t,...l},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":t},l),s?r.createElement("title",{id:t},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"}))}const ae=r.forwardRef(se);function re({title:s,titleId:t,...l},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":t},l),s?r.createElement("title",{id:t},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const le=r.forwardRef(re),oe=[{label:"Last 7 days",value:"7d",days:7},{label:"Last 30 days",value:"30d",days:30},{label:"This month",value:"month",days:0},{label:"This year",value:"year",days:0},{label:"Last year",value:"lastyear",days:0}];function f(s){const t=s.getDate().toString().padStart(2,"0"),l=(s.getMonth()+1).toString().padStart(2,"0"),o=s.getFullYear().toString().slice(-2);return`${t}.${l}.${o}`}function Y(s){const t=new Date;return s.getDate()===t.getDate()&&s.getMonth()===t.getMonth()&&s.getFullYear()===t.getFullYear()}function ne({value:s,onChange:t,className:l=""}){const[o,i]=r.useState(!1),[c,h]=r.useState(s||"year"),[u,y]=r.useState(new Date().getFullYear()),p=r.useRef(null),g=new Date().getFullYear(),v=Array.from({length:5},(a,x)=>g-x);r.useEffect(()=>{function a(x){p.current&&!p.current.contains(x.target)&&i(!1)}return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);const F=a=>{h(a.value),t&&t({range:a.value,days:a.days,year:a.value==="lastyear"?g-1:g}),i(!1)},w=a=>{y(a),h("custom"),t&&t({range:"custom",year:a}),i(!1)},N=()=>{const a=new Date,x=Y(a)?"Today":f(a);if(c==="7d"){const m=new Date(a.getTime()-6048e5);return`${f(m)}-${x}`}if(c==="30d"){const m=new Date(a.getTime()-2592e6);return`${f(m)}-${x}`}if(c==="month"){const m=new Date(a.getFullYear(),a.getMonth(),1);return`${f(m)}-${x}`}if(c==="year"){const m=new Date(g,0,1);return`${f(m)}-${x}`}if(c==="lastyear"){const m=new Date(g-1,0,1),b=new Date(g-1,11,31);return`${f(m)}-${f(b)}`}if(c==="custom"){const m=new Date(u,0,1),b=u===g?a:new Date(u,11,31),A=Y(b)?"Today":f(b);return`${f(m)}-${A}`}return"Select range"};return e.jsxs("div",{className:`relative ${l}`,ref:p,children:[e.jsxs("button",{onClick:()=>i(!o),className:"flex items-center space-x-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors shadow-sm",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"}),e.jsx("span",{className:"text-gray-800 dark:text-gray-200 font-medium",children:N()}),e.jsx(W,{className:`h-4 w-4 text-gray-500 dark:text-gray-400 transition-transform ${o?"rotate-180":""}`})]}),o&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:[e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 px-2 mb-2 font-medium",children:"Quick Select"}),oe.map(a=>e.jsx("button",{onClick:()=>F(a),className:`w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ${c===a.value?"bg-[#1d3557] text-white":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:a.label},a.value))]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-2",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 px-2 mb-2 font-medium",children:"Select Year"}),e.jsx("div",{className:"flex flex-wrap gap-2 px-2",children:v.map(a=>e.jsx("button",{onClick:()=>w(a),className:`px-3 py-1 text-sm rounded-lg transition-colors ${u===a&&c==="custom"?"bg-[#1d3557] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:a},a))})]})]})]})}const P=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899"];function k({title:s,value:t,icon:l,color:o="blue",trend:i,onClick:c,subtitle:h,clickable:u=!0}){const y={blue:"bg-blue-900/50 text-blue-400",green:"bg-green-900/50 text-green-400",yellow:"bg-yellow-900/50 text-yellow-400",red:"bg-red-900/50 text-red-400",purple:"bg-purple-900/50 text-purple-400"},p=u?"cursor-pointer hover:shadow-lg hover:scale-[1.02] hover:border-blue-500":"";return e.jsxs("div",{onClick:u?c:void 0,className:`stat-card transition-all duration-200 border-2 border-transparent ${p} group`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`p-2 rounded-lg ${y[o]} transition-transform group-hover:scale-110`,children:e.jsx(l,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[i!==void 0&&e.jsxs("span",{className:`text-sm font-medium ${i>0?"text-green-600":i<0?"text-red-600":"text-gray-500"}`,children:[i>0?"+":"",i,"%"]}),u&&e.jsx(te,{className:"h-4 w-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"stat-value",children:t}),e.jsx("p",{className:"stat-label",children:s}),h&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h})]})]})}function D({icon:s,label:t,onClick:l,color:o="blue"}){const i={blue:"bg-blue-900/40 text-blue-300 hover:bg-blue-900/60 border border-blue-800",green:"bg-green-900/40 text-green-300 hover:bg-green-900/60 border border-green-800",purple:"bg-purple-900/40 text-purple-300 hover:bg-purple-900/60 border border-purple-800"};return e.jsxs("button",{onClick:l,className:`flex items-center px-4 py-2 rounded-lg text-sm font-semibold transition-colors shadow-sm ${i[o]}`,children:[e.jsx(s,{className:"h-4 w-4 mr-2"}),t]})}function ie(s){if(!s)return"";const t=new Date(s),l=t.getDate().toString().padStart(2,"0"),o=(t.getMonth()+1).toString().padStart(2,"0");return`${l}.${o}`}function de(s){if(!s)return"";const t=new Date(s),l=t.getDate().toString().padStart(2,"0"),o=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getFullYear();return`${l}.${o}.${i}`}function be(){const s=q(),{darkMode:t}=G(),[l,o]=r.useState(null),[i,c]=r.useState([]),[h,u]=r.useState([]),[y,p]=r.useState([]),[g,v]=r.useState(null),[F,w]=r.useState(!0),[N,a]=r.useState(null),[x,m]=r.useState({range:"year",year:new Date().getFullYear()});async function b(){try{w(!0);const n=x.range==="7d"?7:x.range==="30d"?30:365,[d,T,K,U,z]=await Promise.all([j.getOverview(),j.getCostTrends(n),j.getModelUsage(),j.getLeaderboard(10),j.getApprovalStats()]);o(d),c(T.map(C=>({...C,displayDate:ie(C.date),fullDate:de(C.date)}))),u(K),p(U),v(z),a(null)}catch(n){a(n?.message||"Failed to load dashboard data"),o(null),c([]),u([]),p([]),v(null)}finally{w(!1)}}return r.useEffect(()=>{b()},[x]),F?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#1d3557]"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Dashboard"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Overview of your Alfred token usage and quotas"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx(ne,{value:x.range,onChange:m})})]}),N&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-900/30 text-yellow-400 rounded-lg text-sm flex items-center justify-between",children:[e.jsxs("div",{children:["API error: ",N,". Demo data not used."]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>b(),className:"btn btn-primary",children:"Retry"}),e.jsx("a",{href:"mailto:support@example.com",className:"btn btn-secondary",children:"Contact Support"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[e.jsx(D,{icon:R,label:"Add User",onClick:()=>s("/users"),color:"blue"}),e.jsx(D,{icon:E,label:"Create Team",onClick:()=>s("/teams"),color:"green"}),e.jsx(D,{icon:Q,label:"View Reports",onClick:()=>s("/transfers"),color:"purple"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-8",children:[e.jsx(k,{title:"Total Users",value:l?.total_users||0,icon:R,color:"blue",trend:12,subtitle:"Click to manage users",onClick:()=>s("/users")}),e.jsx(k,{title:"Tokens Used",value:(l?.total_tokens_used||0).toLocaleString(),icon:X,color:"green",trend:8,subtitle:"Click for detailed breakdown",onClick:()=>s("/transfers")}),e.jsx(k,{title:"Total Cost",value:`$${(l?.total_credits_spent||0).toFixed(2)}`,icon:le,color:"yellow",trend:-3,subtitle:"Click for cost analysis",onClick:()=>s("/transfers")}),e.jsx(k,{title:"Active Teams",value:l?.total_teams||0,icon:E,color:"purple",subtitle:"Click to manage teams",onClick:()=>s("/teams")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6 mb-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Token Usage Trend"})}),e.jsx(S,{width:"100%",height:300,children:e.jsxs(B,{data:i,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorTokens",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]})}),e.jsx(O,{strokeDasharray:"3 3",stroke:t?"#374151":"#f0f0f0"}),e.jsx(_,{dataKey:"displayDate",tick:{fontSize:12,fill:t?"#9CA3AF":"#6B7280"}}),e.jsx(L,{tick:{fontSize:12,fill:t?"#9CA3AF":"#6B7280"}}),e.jsx($,{contentStyle:{backgroundColor:t?"#1F2937":"#ffffff",border:`1px solid ${t?"#374151":"#E5E7EB"}`,borderRadius:"8px",color:t?"#F3F4F6":"#111827"},labelStyle:{color:t?"#F3F4F6":"#111827",fontWeight:600},itemStyle:{color:t?"#9CA3AF":"#4B5563"},formatter:(n,d,T)=>[n.toLocaleString(),"Tokens"],labelFormatter:(n,d)=>d?.[0]?.payload?.fullDate?d[0].payload.fullDate:n}),e.jsx(M,{type:"monotone",dataKey:"tokens",stroke:"#3B82F6",fillOpacity:1,fill:"url(#colorTokens)",name:"Tokens"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Cost Trend"})}),e.jsx(S,{width:"100%",height:300,children:e.jsxs(B,{data:i,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorCost",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})}),e.jsx(O,{strokeDasharray:"3 3",stroke:t?"#374151":"#f0f0f0"}),e.jsx(_,{dataKey:"displayDate",tick:{fontSize:12,fill:t?"#9CA3AF":"#6B7280"}}),e.jsx(L,{tick:{fontSize:12,fill:t?"#9CA3AF":"#6B7280"},tickFormatter:n=>`$${n}`}),e.jsx($,{contentStyle:{backgroundColor:t?"#1F2937":"#ffffff",border:`1px solid ${t?"#374151":"#E5E7EB"}`,borderRadius:"8px",color:t?"#F3F4F6":"#111827"},labelStyle:{color:t?"#F3F4F6":"#111827",fontWeight:600},itemStyle:{color:t?"#9CA3AF":"#4B5563"},formatter:n=>[`$${n.toFixed(2)}`,"Cost"],labelFormatter:(n,d)=>d?.[0]?.payload?.fullDate?d[0].payload.fullDate:n}),e.jsx(M,{type:"monotone",dataKey:"cost",stroke:"#10B981",fillOpacity:1,fill:"url(#colorCost)",name:"Cost"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Model Usage"}),e.jsx(S,{width:"100%",height:250,children:e.jsxs(Z,{children:[e.jsx(H,{data:h,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"requests",nameKey:"model",label:({model:n})=>n,children:h.map((n,d)=>e.jsx(J,{fill:P[d%P.length]},`cell-${d}`))}),e.jsx($,{contentStyle:{backgroundColor:t?"#1F2937":"#ffffff",border:`1px solid ${t?"#374151":"#E5E7EB"}`,borderRadius:"8px",color:t?"#F3F4F6":"#111827"},labelStyle:{color:t?"#F3F4F6":"#111827",fontWeight:600},itemStyle:{color:t?"#9CA3AF":"#4B5563"}})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Efficiency Leaderboard"}),e.jsx("button",{onClick:()=>s("/users"),className:"text-xs text-blue-400 hover:underline",children:"View all"})]}),e.jsx("div",{className:"space-y-3",children:y.slice(0,5).map((n,d)=>e.jsxs("div",{className:"flex items-center p-2 rounded-lg hover:bg-gray-700 cursor-pointer transition-colors",onClick:()=>s("/users"),children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold mr-3 ${d===0?"bg-yellow-900/50 text-yellow-400":d===1?"bg-gray-600 text-gray-200":d===2?"bg-orange-900/50 text-orange-400":"bg-gray-700 text-gray-400"}`,children:d+1}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-white truncate",children:n.name})}),e.jsxs("span",{className:"text-sm font-semibold text-green-600",children:[(n.efficiency_score*100).toFixed(0),"%"]})]},n.user_id))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Approval Statistics"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ee,{className:"h-5 w-5 text-yellow-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Pending"})]}),e.jsx("span",{className:"text-lg font-semibold text-white",children:g?.total_pending||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-5 w-5 text-green-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Approved (7d)"})]}),e.jsx("span",{className:"text-lg font-semibold text-white",children:g?.total_approved_7d||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Denied (7d)"})]}),e.jsx("span",{className:"text-lg font-semibold text-white",children:g?.total_rejected_7d||0})]}),e.jsx("div",{className:"pt-3 border-t border-gray-700",children:e.jsxs("p",{className:"text-sm text-gray-400",children:["Avg. approval time: ",e.jsxs("span",{className:"font-semibold text-white",children:[g?.avg_approval_time_hours?.toFixed(1)||0,"h"]})]})})]})]})]})]})}export{be as default};
