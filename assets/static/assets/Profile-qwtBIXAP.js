import{i as U,f as A,e as u,j as e,a as D,o as q}from"./index-BpBXMnYt.js";import{r as s}from"./vendor-CoKE50sv.js";import{F}from"./CogIcon-D1XAni0z.js";import{a as V,F as T}from"./ChartBarIcon-DrjqaP5B.js";import{F as W}from"./ClockIcon-DqX5lot2.js";import{F as H}from"./ShieldCheckIcon-DH-zSt_N.js";import{F as I}from"./KeyIcon-BEVIebXh.js";function Y({title:t,titleId:n,...i},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},i),t?s.createElement("title",{id:n},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))}const B=s.forwardRef(Y);function O({title:t,titleId:n,...i},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},i),t?s.createElement("title",{id:n},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const Q=s.forwardRef(O);function K({title:t,titleId:n,...i},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":n},i),t?s.createElement("title",{id:n},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"}))}const G=s.forwardRef(K);function h({icon:t,label:n,value:i,color:l="blue"}){const d={blue:"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300",green:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300",yellow:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-300",purple:"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-300"};return e.jsxs("div",{className:"flex items-center p-4 rounded-lg bg-gray-50 dark:bg-gray-700",children:[e.jsx("div",{className:`p-2 rounded-lg ${d[l]}`,children:e.jsx(t,{className:"h-5 w-5"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:i})]})]})}function se(){const{user:t,updateUser:n,refetch:i}=U(),{showToast:l}=A(),[d,f]=s.useState(!1),[o,g]=s.useState({name:"",email:""}),[M,j]=s.useState([]),[p,w]=s.useState({email_alerts:!0,quota_warnings:!0,weekly_reports:!1}),[m,k]=s.useState(!1),[v,N]=s.useState("normal"),[S,x]=s.useState(!1);s.useEffect(()=>{t&&(g({name:t.name||"",email:t.email||""}),t.preferences&&t.preferences.notifications&&w(a=>({...a,...t.preferences.notifications})),k(t.status==="on_vacation"||t.on_vacation||!1),N(t.default_privacy||"normal"),R())},[t]);const R=async()=>{try{const a=await u.getUsageAnalytics(7);a.history&&j(a.history.map(r=>({date:new Date(r.date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"}),tokens:r.tokens,cost:r.cost})))}catch(a){console.error("Failed to fetch usage history:",a),j([{date:"12-02",tokens:1250,cost:.15},{date:"11-02",tokens:2100,cost:.25},{date:"10-02",tokens:1800,cost:.22},{date:"09-02",tokens:3200,cost:.38},{date:"08-02",tokens:2500,cost:.3}])}},$=async()=>{try{const a={...o,preferences:{...t.preferences||{},notifications:p}};await u.updateProfile(a),n(a),f(!1),l("Profile updated successfully","success")}catch(a){l(a.message||"Failed to update profile","error")}},L=async()=>{const a=m?"active":"on_vacation";try{x(!0),await u.updateUserStatus(a),k(!m),l(m?"Vacation mode disabled":"Vacation mode enabled - your quota is now shared with team","success"),i&&i()}catch(r){l(r.message||"Failed to update status","error")}finally{x(!1)}},_=async()=>{const a=v==="strict"?"normal":"strict";try{x(!0),await u.updatePrivacyMode(a),N(a),l(a==="strict"?"Privacy mode enabled - messages will not be logged":"Privacy mode disabled","success"),i&&i()}catch(r){l(r.message||"Failed to update privacy mode","error")}finally{x(!1)}},E=a=>{if(!a)return"N/A";const r=new Date(a),y=r.getDate().toString().padStart(2,"0"),b=(r.getMonth()+1).toString().padStart(2,"0");return`${y}-${b}`},P=a=>{if(!a)return"N/A";const r=new Date(a),y=r.getDate().toString().padStart(2,"0"),b=(r.getMonth()+1).toString().padStart(2,"0"),C=r.getFullYear().toString().slice(-2);return`${y}-${b}-${C}`};if(!t)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const c=t.personal_quota?Math.round(t.used_tokens/t.personal_quota*100):0;return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"My Profile"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your account settings and preferences"})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-[#1d3557] flex items-center justify-center text-3xl font-bold text-white",children:t.name?t.name.charAt(0).toUpperCase():"U"}),e.jsx("div",{className:"ml-6",children:d?e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",value:o.name,onChange:a=>g({...o,name:a.target.value}),className:"input text-lg font-semibold",placeholder:"Your name"}),e.jsx("input",{type:"email",value:o.email,onChange:a=>g({...o,email:a.target.value}),className:"input",placeholder:"Your email"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t.name}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 flex items-center mt-1",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),t.email]}),e.jsxs("div",{className:"flex items-center mt-2 space-x-3",children:[e.jsx("span",{className:"badge badge-primary",children:t.role||"User"}),t.team&&e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center",children:[e.jsx(D,{className:"h-4 w-4 mr-1"}),t.team]})]})]})})]}),e.jsx("div",{children:d?e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:$,className:"btn btn-primary",children:"Save"}),e.jsx("button",{onClick:()=>f(!1),className:"btn btn-secondary",children:"Cancel"})]}):e.jsxs("button",{onClick:()=>f(!0),className:"btn btn-secondary flex items-center",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(h,{icon:V,label:"Tokens Used",value:(t.used_tokens||0).toLocaleString(),color:"blue"}),e.jsx(h,{icon:T,label:"Quota Remaining",value:`${c}%`,color:c>80?"yellow":"green"}),e.jsx(h,{icon:W,label:"Last Login",value:E(t.last_login),color:"purple"}),e.jsx(h,{icon:H,label:"Member Since",value:P(t.created_at),color:"blue"})]})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quota Usage"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:[(t.used_tokens||0).toLocaleString()," / ",(t.personal_quota||5e4).toLocaleString()," tokens"]}),e.jsxs("span",{className:`font-medium ${c>80?"text-yellow-600":"text-green-600"}`,children:[c,"% used"]})]}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${c>90?"bg-red-500":c>70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(c,100)}%`}})})]})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Status & Privacy"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-yellow-100 dark:bg-yellow-900/30 mr-3",children:e.jsx(G,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Vacation Mode"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Share up to 10% of your quota with team members while away"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:L,disabled:S,className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-yellow-500"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/30 mr-3",children:e.jsx(Q,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Strict Privacy Mode"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"When enabled, your messages and responses will not be logged"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:v==="strict",onChange:_,disabled:S,className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-500"})]})]})]})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Usage"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Tokens"}),e.jsx("th",{children:"Cost"})]})}),e.jsx("tbody",{children:M.map((a,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:a.date}),e.jsx("td",{children:a.tokens.toLocaleString()}),e.jsxs("td",{children:["$",a.cost.toFixed(2)]})]},r))})]})})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Notification Preferences"]}),e.jsx("div",{className:"space-y-4",children:[{key:"email_alerts",label:"Email Alerts",desc:"Receive email notifications for important events"},{key:"quota_warnings",label:"Quota Warnings",desc:"Get notified when quota is running low"},{key:"weekly_reports",label:"Weekly Reports",desc:"Receive weekly usage summary via email"}].map(a=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:p[a.key],onChange:r=>w({...p,[a.key]:r.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[#1d3557]"})]})]},a.key))})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Security"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"API Key"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Your API key is stored securely"})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-mono",children:"tp-****...****"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Regenerate API Key"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"This will invalidate your current key"})]}),e.jsx("button",{className:"btn btn-danger text-sm",children:"Regenerate"})]})]})]})]})}export{se as default};
