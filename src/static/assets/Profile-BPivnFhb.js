import{c as L,b as T,a as m,j as e}from"./index-C1A5pA5l.js";import{r as l}from"./vendor-CoKE50sv.js";import{y as A,U as E,c as _,o as R,T as V,p as I,S as K,z as Y,E as H,g as Q,K as W}from"./icons-iorli5jj.js";function u({icon:a,label:h,value:c,color:r="blue"}){const d={blue:"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300",green:"bg-green-100 text-green-600 dark:bg-green-900 dark:text-green-300",yellow:"bg-yellow-100 text-yellow-600 dark:bg-yellow-900 dark:text-yellow-300",purple:"bg-purple-100 text-purple-600 dark:bg-purple-900 dark:text-purple-300"};return e.jsxs("div",{className:"flex items-center p-4 rounded-lg bg-gray-50 dark:bg-gray-700",children:[e.jsx("div",{className:`p-2 rounded-lg ${d[r]}`,children:e.jsx(a,{className:"h-5 w-5"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:h}),e.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:c})]})]})}function O(){const{user:a,updateUser:h,refetch:c}=L(),{showToast:r}=T(),[d,g]=l.useState(!1),[i,f]=l.useState({name:"",email:""}),[P,j]=l.useState([]),[p,k]=l.useState({email_alerts:!0,quota_warnings:!0,weekly_reports:!1}),[o,N]=l.useState(!1),[w,v]=l.useState("normal"),[S,x]=l.useState(!1);l.useEffect(()=>{a&&(f({name:a.name||"",email:a.email||""}),a.preferences&&a.preferences.notifications&&k(t=>({...t,...a.preferences.notifications})),N(a.status==="on_vacation"||a.on_vacation||!1),v(a.default_privacy||"normal"),U())},[a]);const U=async()=>{try{const t=await m.getUsageAnalytics(7);t.history&&j(t.history.map(s=>({date:new Date(s.date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"}),tokens:s.tokens,cost:s.cost})))}catch(t){console.error("Failed to fetch usage history:",t),j([{date:"12-02",tokens:1250,cost:.15},{date:"11-02",tokens:2100,cost:.25},{date:"10-02",tokens:1800,cost:.22},{date:"09-02",tokens:3200,cost:.38},{date:"08-02",tokens:2500,cost:.3}])}},C=async()=>{try{const t={...i,preferences:{...a.preferences||{},notifications:p}};await m.updateProfile(t),h(t),g(!1),r("Profile updated successfully","success")}catch(t){r(t.message||"Failed to update profile","error")}},M=async()=>{const t=o?"active":"on_vacation";try{x(!0),await m.updateUserStatus(t),N(!o),r(o?"Vacation mode disabled":"Vacation mode enabled - your quota is now shared with team","success"),c&&c()}catch(s){r(s.message||"Failed to update status","error")}finally{x(!1)}},D=async()=>{const t=w==="strict"?"normal":"strict";try{x(!0),await m.updatePrivacyMode(t),v(t),r(t==="strict"?"Privacy mode enabled - messages will not be logged":"Privacy mode disabled","success"),c&&c()}catch(s){r(s.message||"Failed to update privacy mode","error")}finally{x(!1)}},$=t=>{if(!t)return"N/A";const s=new Date(t),y=s.getDate().toString().padStart(2,"0"),b=(s.getMonth()+1).toString().padStart(2,"0");return`${y}-${b}`},q=t=>{if(!t)return"N/A";const s=new Date(t),y=s.getDate().toString().padStart(2,"0"),b=(s.getMonth()+1).toString().padStart(2,"0"),F=s.getFullYear().toString().slice(-2);return`${y}-${b}-${F}`};if(!a)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const n=a.personal_quota?Math.round(a.used_tokens/a.personal_quota*100):0;return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"My Profile"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage your account settings and preferences"})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-20 w-20 rounded-full bg-[#1d3557] flex items-center justify-center text-3xl font-bold text-white",children:a.name?a.name.charAt(0).toUpperCase():"U"}),e.jsx("div",{className:"ml-6",children:d?e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",value:i.name,onChange:t=>f({...i,name:t.target.value}),className:"input text-lg font-semibold",placeholder:"Your name"}),e.jsx("input",{type:"email",value:i.email,onChange:t=>f({...i,email:t.target.value}),className:"input",placeholder:"Your email"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.name}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 flex items-center mt-1",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),a.email]}),e.jsxs("div",{className:"flex items-center mt-2 space-x-3",children:[e.jsx("span",{className:"badge badge-primary",children:a.role||"User"}),a.team&&e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center",children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),a.team]})]})]})})]}),e.jsx("div",{children:d?e.jsxs("div",{className:"space-x-2",children:[e.jsx("button",{onClick:C,className:"btn btn-primary",children:"Save"}),e.jsx("button",{onClick:()=>g(!1),className:"btn btn-secondary",children:"Cancel"})]}):e.jsxs("button",{onClick:()=>g(!0),className:"btn btn-secondary flex items-center",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(u,{icon:R,label:"Tokens Used",value:(a.used_tokens||0).toLocaleString(),color:"blue"}),e.jsx(u,{icon:V,label:"Quota Remaining",value:`${n}%`,color:n>80?"yellow":"green"}),e.jsx(u,{icon:I,label:"Last Login",value:$(a.last_login),color:"purple"}),e.jsx(u,{icon:K,label:"Member Since",value:q(a.created_at),color:"blue"})]})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quota Usage"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-300",children:[(a.used_tokens||0).toLocaleString()," / ",(a.personal_quota||5e4).toLocaleString()," tokens"]}),e.jsxs("span",{className:`font-medium ${n>80?"text-yellow-600":"text-green-600"}`,children:[n,"% used"]})]}),e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${n>90?"bg-red-500":n>70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(n,100)}%`}})})]})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(_,{className:"h-5 w-5 mr-2"}),"Status & Privacy"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-yellow-100 dark:bg-yellow-900/30 mr-3",children:e.jsx(Y,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Vacation Mode"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Share up to 10% of your quota with team members while away"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:M,disabled:S,className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-yellow-500"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/30 mr-3",children:e.jsx(H,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Strict Privacy Mode"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"When enabled, your messages and responses will not be logged"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:w==="strict",onChange:D,disabled:S,className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-500"})]})]})]})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Usage"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Tokens"}),e.jsx("th",{children:"Cost"})]})}),e.jsx("tbody",{children:P.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.date}),e.jsx("td",{children:t.tokens.toLocaleString()}),e.jsxs("td",{children:["$",t.cost.toFixed(2)]})]},s))})]})})]}),e.jsxs("div",{className:"card mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Q,{className:"h-5 w-5 mr-2"}),"Notification Preferences"]}),e.jsx("div",{className:"space-y-4",children:[{key:"email_alerts",label:"Email Alerts",desc:"Receive email notifications for important events"},{key:"quota_warnings",label:"Quota Warnings",desc:"Get notified when quota is running low"},{key:"weekly_reports",label:"Weekly Reports",desc:"Receive weekly usage summary via email"}].map(t=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:t.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:p[t.key],onChange:s=>k({...p,[t.key]:s.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[#1d3557]"})]})]},t.key))})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(W,{className:"h-5 w-5 mr-2"}),"Security"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"API Key"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Your API key is stored securely"})]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-mono",children:"tp-****...****"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Regenerate API Key"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"This will invalidate your current key"})]}),e.jsx("button",{className:"btn btn-danger text-sm",children:"Regenerate"})]})]})]})]})}export{O as default};
