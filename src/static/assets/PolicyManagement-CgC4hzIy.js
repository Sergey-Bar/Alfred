import{j as e,a as r}from"./index-DmO1ypIk.js";import{r as l}from"./vendor-CoKE50sv.js";import{a4 as j,Q as m,aa as v,v as f,o as N,V as b,n as _,w,x as P}from"./icons-UwgmH0ZI.js";const d=[{id:"pol-001",name:"Premium Model Gating",description:"Only allow premium tier users to access GPT-4 and Claude Opus",active:!0,dry_run:!1,evaluations_24h:12450,denials_24h:342,created_at:"2026-01-15T10:00:00Z"},{id:"pol-002",name:"Token Limit Enforcement",description:"Block requests exceeding 100K tokens",active:!0,dry_run:!1,evaluations_24h:45200,denials_24h:18,created_at:"2026-01-20T14:00:00Z"},{id:"pol-003",name:"PII Model Restriction",description:"Route requests with detected PII to privacy-compliant models only",active:!0,dry_run:!0,evaluations_24h:8900,denials_24h:0,created_at:"2026-02-01T09:00:00Z"},{id:"pol-004",name:"EU Data Residency",description:"Ensure EU user data stays in EU regions",active:!1,dry_run:!1,evaluations_24h:0,denials_24h:0,created_at:"2026-02-10T11:00:00Z"}],T=[{id:"premium_model_gating",name:"Premium Model Gating",description:"Restrict premium models to specific user tiers"},{id:"token_limit",name:"Token Limit",description:"Enforce maximum token limits per request"},{id:"rate_limit_per_user",name:"Rate Limit Per User",description:"Per-user rate limiting rules"},{id:"geo_restriction",name:"Geographic Restriction",description:"Block or allow based on user region"},{id:"pii_model_restriction",name:"PII Model Restriction",description:"Route PII-containing requests to compliant models"},{id:"data_classification",name:"Data Classification",description:"Route based on data sensitivity levels"},{id:"time_of_day",name:"Time-of-Day",description:"Different rules for peak vs off-peak hours"},{id:"budget_routing",name:"Budget-Based Routing",description:"Route based on remaining budget"}];function k({pol:i,onToggle:t,onToggleDryRun:c,onDelete:n}){return e.jsxs("div",{className:"card hover-lift",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${i.active?"bg-green-100":"bg-gray-100"}`,children:e.jsx(m,{className:`w-5 h-5 ${i.active?"text-green-600":"text-gray-500"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:i.name}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-primary-500)"},children:i.description})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{className:"btn btn-ghost p-1.5",title:"Edit",children:e.jsx(w,{className:"w-4 h-4"})}),e.jsx("button",{className:"btn btn-ghost p-1.5 text-red-500",title:"Delete",onClick:()=>n(i.id),children:e.jsx(P,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.active,onChange:()=>t(i.id),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm",children:"Active"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.dry_run,onChange:()=>c(i.id),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm text-yellow-600",children:"Dry Run"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-3",style:{borderTop:"1px solid var(--color-border)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs",style:{color:"var(--color-primary-500)"},children:"Evaluations (24h)"}),e.jsx("p",{className:"text-lg font-semibold",children:i.evaluations_24h.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs",style:{color:"var(--color-primary-500)"},children:"Denials (24h)"}),e.jsx("p",{className:"text-lg font-semibold text-red-600",children:i.denials_24h.toLocaleString()})]})]})]})}function E(){const[i,t]=l.useState([]),[c,n]=l.useState(!0),[o,x]=l.useState(!1);l.useEffect(()=>{async function a(){try{const s=await r.getPolicies?.()||[];t(s.length>0?s:d)}catch(s){console.warn("Failed to fetch policies, using demo data:",s),t(d)}finally{n(!1)}}a()},[]);const h=async a=>{t(i.map(s=>s.id===a?{...s,active:!s.active}:s));try{await r.updatePolicy?.(a,{active:!i.find(s=>s.id===a).active})}catch(s){console.error("Failed to update policy:",s)}},u=async a=>{t(i.map(s=>s.id===a?{...s,dry_run:!s.dry_run}:s));try{await r.updatePolicyDryRun?.(a,!i.find(s=>s.id===a).dry_run)}catch(s){console.error("Failed to update dry run:",s)}},p=async a=>{if(window.confirm("Delete this policy?"))try{await r.deletePolicy?.(a),t(i.filter(s=>s.id!==a))}catch(s){console.error("Failed to delete policy:",s)}};if(c)return e.jsx("div",{className:"p-6 flex items-center justify-center",children:e.jsx(j,{className:"w-6 h-6 animate-spin"})});const g=i.filter(a=>a.active).length,y=i.filter(a=>a.dry_run).length;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"page-header flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-6 h-6",style:{color:"var(--color-accent-600)"}}),"Policies"]}),e.jsx("p",{className:"subtitle",children:"Manage OPA governance policies for AI request routing and access control"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>x(!o),children:[e.jsx(v,{className:"w-4 h-4 mr-2"})," Templates"]}),e.jsxs("button",{className:"btn btn-primary",children:[e.jsx(f,{className:"w-4 h-4 mr-2"})," Create Policy"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"card flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-green-100",children:e.jsx(N,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:g}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-primary-500)"},children:"Active Policies"})]})]}),e.jsxs("div",{className:"card flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-yellow-100",children:e.jsx(b,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:y}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-primary-500)"},children:"Dry Run Mode"})]})]}),e.jsxs("div",{className:"card flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-red-100",children:e.jsx(_,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:i.reduce((a,s)=>a+s.denials_24h,0).toLocaleString()}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-primary-500)"},children:"Denials (24h)"})]})]})]}),o&&e.jsxs("div",{className:"card",style:{background:"var(--color-primary-50)"},children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Built-in Policy Templates"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:T.map(a=>e.jsxs("button",{className:"p-3 rounded-lg text-left hover:bg-white transition-colors",style:{background:"var(--color-background)"},children:[e.jsx("p",{className:"font-medium text-sm",children:a.name}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--color-primary-500)"},children:a.description})]},a.id))})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:i.map(a=>e.jsx(k,{pol:a,onToggle:h,onToggleDryRun:u,onDelete:p},a.id))})]})}export{E as default};
