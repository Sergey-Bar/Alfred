#nginxloadbalancerconfigforhorizontalscalingvalidation(T210)##Model:ClaudeOpus4.6#Tier:L1#Logic:Round-robinloadbalancingacrossgatewayreplicas.#DockerDNSresolves'gateway'toallscaledinstances.#RootCause:SprinttaskT210—Horizontalscalingvalidation.#Context:Distributesk6loadevenlyacrossgatewayreplicas.#Suitability:L1—Standardnginxreverseproxyconfig.worker_processesauto;events{worker_connections4096;multi_accepton;}http{#ResolveDockerDNSdynamicallyresolver127.0.0.11valid=5s;upstreamgateway_cluster{#DockerComposeDNSresolves'gateway'toallscaledinstancesservergateway:8080;#Connectionpooling—keepupstreamconnectionsalivekeepalive64;keepalive_timeout60s;}#Logging—minimalforbenchmarkaccuracylog_formatperf'$remote_addr-$status$request_time$upstream_response_time$upstream_addr';access_log/dev/stdoutperf;error_log/dev/stderrwarn;server{listen8080;server_name_;#Proxysettingsproxy_http_version1.1;proxy_set_headerConnection"";proxy_set_headerHost$host;proxy_set_headerX-Real-IP$remote_addr;proxy_set_headerX-Forwarded-For$proxy_add_x_forwarded_for;#SSEstreamingsupportproxy_bufferingoff;proxy_cacheoff;#Timeoutsproxy_connect_timeout5s;proxy_send_timeout60s;proxy_read_timeout300s;#Healthcheck—directpassthroughlocation/healthz{proxy_passhttp://gateway_cluster;}location/ready{proxy_passhttp://gateway_cluster;}#AllAPIrouteslocation/{proxy_passhttp://gateway_cluster;#SSEheadersforstreamingproxy_set_headerAccept-Encoding"";proxy_set_headerCache-Control"no-cache";}#Exposeupstreamstatusfordebugginglocation/nginx-status{stub_statuson;allow172.0.0.0/8;#Dockernetworksdenyall;}}}