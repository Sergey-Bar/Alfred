frompathlibimportPathimportos,sysroot=Path(__file__).resolve().parents[2]_tmp=root/'.pytest_tmp'_tmp.mkdir(exist_ok=True)os.environ.setdefault('DATABASE_URL',f"sqlite:///{_tmp/'test.db'}")os.environ.setdefault('ENVIRONMENT','test')#ensureservices/backendisonpathsrc_backend=root/'services'/'backend'ifstr(src_backend)notinsys.path:sys.path.insert(0,str(src_backend))print('PYTHONPATH[0:3]:',sys.path[0:3])try:importimportlibapp_db=importlib.import_module('app.database')importapp.models#noqa:F401fromsqlalchemyimporttexttry:eng=app_db.get_engine()ifhasattr(app_db,'get_engine')elsegetattr(app_db,'engine')exceptException:eng=getattr(app_db,'engine')print('Enginerepr:',eng)try:witheng.connect()asconn:res=conn.execute(text("SELECTnameFROMsqlite_masterWHEREtype='table'ORDERBYname"))print('tables:',res.fetchall())exceptExceptionase:print('Errorlistingtables:',e)exceptExceptionase:importtracebackprint('Importerror:',e)traceback.print_exc()