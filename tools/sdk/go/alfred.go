//PackagealfredprovidesaGoclientfortheAlfredAICreditGovernanceAPI.////──────────────────────────────────────────────────────────────//Model:ClaudeOpus4.6//Tier:L2//Logic:GoSDKwithtypedmethodsforallAlfredAPIendpoints.//RootCause:SprinttaskT186—GoSDKimplementation.//Context:ProvidesGodeveloperswithnativeSDKforAlfred.//Suitability:L2—StandardHTTPclientpatternswithGoidioms.//──────────────────────────────────────────────────────────────packagealfredimport("bytes""context""encoding/json""fmt""io""net/http""net/url""time")//VersionistheSDKversion.constVersion="1.0.0"//DefaultBaseURListhedefaultAlfredAPIbaseURL.constDefaultBaseURL="http://localhost:8000"//============================================================//Client//============================================================//ClientistheAlfredAPIclient.typeClientstruct{baseURLstringapiKeystringhttpClient*http.ClientuserAgentstring}//ClientOptionconfigurestheclient.typeClientOptionfunc(*Client)//WithBaseURLsetsacustombaseURL.funcWithBaseURL(urlstring)ClientOption{returnfunc(c*Client){c.baseURL=url}}//WithHTTPClientsetsacustomHTTPclient.funcWithHTTPClient(client*http.Client)ClientOption{returnfunc(c*Client){c.httpClient=client}}//WithTimeoutsetsrequesttimeout.funcWithTimeout(timeouttime.Duration)ClientOption{returnfunc(c*Client){c.httpClient.Timeout=timeout}}//NewClientcreatesanewAlfredAPIclient.funcNewClient(apiKeystring,opts...ClientOption)*Client{c:=&Client{baseURL:DefaultBaseURL,apiKey:apiKey,userAgent:fmt.Sprintf("alfred-go-sdk/%s",Version),httpClient:&http.Client{Timeout:30*time.Second,},}for_,opt:=rangeopts{opt(c)}returnc}//requestperformsanHTTPrequest.func(c*Client)request(ctxcontext.Context,method,pathstring,bodyinterface{},resultinterface{})error{varbodyReaderio.Readerifbody!=nil{jsonBody,err:=json.Marshal(body)iferr!=nil{returnfmt.Errorf("marshalbody:%w",err)}bodyReader=bytes.NewReader(jsonBody)}req,err:=http.NewRequestWithContext(ctx,method,c.baseURL+path,bodyReader)iferr!=nil{returnfmt.Errorf("createrequest:%w",err)}req.Header.Set("Authorization","Bearer"+c.apiKey)req.Header.Set("Content-Type","application/json")req.Header.Set("User-Agent",c.userAgent)resp,err:=c.httpClient.Do(req)iferr!=nil{returnfmt.Errorf("dorequest:%w",err)}deferresp.Body.Close()//ReadresponsebodyrespBody,err:=io.ReadAll(resp.Body)iferr!=nil{returnfmt.Errorf("readresponse:%w",err)}//Handleerrorsifresp.StatusCode>=400{returnparseError(resp.StatusCode,respBody)}//Parseresultifresult!=nil&&len(respBody)>0{iferr:=json.Unmarshal(respBody,result);err!=nil{returnfmt.Errorf("unmarshalresponse:%w",err)}}returnnil}//============================================================//ErrorTypes//============================================================//ErrorrepresentsanAPIerror.typeErrorstruct{StatusCodeint`json:"status_code"`Messagestring`json:"message"`Codestring`json:"code,omitempty"`}func(e*Error)Error()string{returnfmt.Sprintf("alfred:%s(status%d)",e.Message,e.StatusCode)}//AuthenticationErrorindicatesinvalidcredentials.typeAuthenticationErrorstruct{Error}//AuthorizationErrorindicatesinsufficientpermissions.typeAuthorizationErrorstruct{Error}//NotFoundErrorindicatesresourcenotfound.typeNotFoundErrorstruct{Error}//ValidationErrorindicatesinvalidrequest.typeValidationErrorstruct{Error}//QuotaExceededErrorindicatescreditlimitreached.typeQuotaExceededErrorstruct{Error}//RateLimitErrorindicatestoomanyrequests.typeRateLimitErrorstruct{Error}funcparseError(statusCodeint,body[]byte)error{varapiErrstruct{Detailstring`json:"detail"`Codestring`json:"code"`}_=json.Unmarshal(body,&apiErr)baseErr:=Error{StatusCode:statusCode,Message:apiErr.Detail,Code:apiErr.Code,}ifbaseErr.Message==""{baseErr.Message=http.StatusText(statusCode)}switchstatusCode{case401:return&AuthenticationError{Error:baseErr}case403:return&AuthorizationError{Error:baseErr}case404:return&NotFoundError{Error:baseErr}case422:return&ValidationError{Error:baseErr}case429:ifapiErr.Code=="quota_exceeded"{return&QuotaExceededError{Error:baseErr}}return&RateLimitError{Error:baseErr}default:return&baseErr}}//============================================================//Models//============================================================//Userrepresentsauser.typeUserstruct{IDstring`json:"id"`Emailstring`json:"email"`Namestring`json:"name"`Rolestring`json:"role"`TeamID*string`json:"team_id,omitempty"`CreatedAttime.Time`json:"created_at"`UpdatedAt*time.Time`json:"updated_at,omitempty"`}//Teamrepresentsateam.typeTeamstruct{IDstring`json:"id"`Namestring`json:"name"`Descriptionstring`json:"description,omitempty"`CreatedAttime.Time`json:"created_at"`UpdatedAt*time.Time`json:"updated_at,omitempty"`}//Walletrepresentsacreditwallet.typeWalletstruct{IDstring`json:"id"`OwnerIDstring`json:"owner_id"`OwnerTypestring`json:"owner_type"`Balancefloat64`json:"balance"`SoftLimitfloat64`json:"soft_limit"`HardLimitfloat64`json:"hard_limit"`Currencystring`json:"currency"`CreatedAttime.Time`json:"created_at"`UpdatedAt*time.Time`json:"updated_at,omitempty"`}//Transactionrepresentsaledgertransaction.typeTransactionstruct{IDstring`json:"id"`WalletIDstring`json:"wallet_id"`Typestring`json:"type"`Amountfloat64`json:"amount"`Balancefloat64`json:"balance"`Descriptionstring`json:"description,omitempty"`MetadataJSONMap`json:"metadata,omitempty"`CreatedAttime.Time`json:"created_at"`}//Transferrepresentsacredittransfer.typeTransferstruct{IDstring`json:"id"`FromWalletIDstring`json:"from_wallet_id"`ToWalletIDstring`json:"to_wallet_id"`Amountfloat64`json:"amount"`Statusstring`json:"status"`RequireApprovalbool`json:"require_approval"`ApprovedBy*string`json:"approved_by,omitempty"`ApprovedAt*time.Time`json:"approved_at,omitempty"`CreatedAttime.Time`json:"created_at"`}//APIKeyrepresentsanAPIkey.typeAPIKeystruct{IDstring`json:"id"`Namestring`json:"name"`Prefixstring`json:"prefix"`UserIDstring`json:"user_id"`Scopes[]string`json:"scopes"`ExpiresAt*time.Time`json:"expires_at,omitempty"`CreatedAttime.Time`json:"created_at"`LastUsed*time.Time`json:"last_used,omitempty"`}//APIKeyWithSecretincludesthefullkey(onlyoncreation).typeAPIKeyWithSecretstruct{APIKeyKeystring`json:"key"`}//ProviderrepresentsanLLMprovider.typeProviderstruct{IDstring`json:"id"`Namestring`json:"name"`BaseURLstring`json:"base_url"`Statusstring`json:"status"`Latencyfloat64`json:"latency_ms,omitempty"`ErrorRatefloat64`json:"error_rate,omitempty"`}//Policyrepresentsagovernancepolicy.typePolicystruct{IDstring`json:"id"`Namestring`json:"name"`Descriptionstring`json:"description,omitempty"`Rules[]string`json:"rules"`Priorityint`json:"priority"`Enabledbool`json:"enabled"`CreatedAttime.Time`json:"created_at"`}//ExperimentrepresentsanA/Broutingexperiment.typeExperimentstruct{IDstring`json:"id"`Namestring`json:"name"`Descriptionstring`json:"description,omitempty"`Statusstring`json:"status"`TrafficSplitmap[string]int`json:"traffic_split"`Metricsmap[string]interface{}`json:"metrics,omitempty"`StartedAt*time.Time`json:"started_at,omitempty"`EndedAt*time.Time`json:"ended_at,omitempty"`CreatedAttime.Time`json:"created_at"`}//UsageReportcontainsusageanalytics.typeUsageReportstruct{TotalRequestsint`json:"total_requests"`TotalTokensint`json:"total_tokens"`TotalCostfloat64`json:"total_cost"`ByModelmap[string]ModelUsage`json:"by_model,omitempty"`ByProvidermap[string]float64`json:"by_provider,omitempty"`Periodstring`json:"period"`StartDatetime.Time`json:"start_date"`EndDatetime.Time`json:"end_date"`}//ModelUsagecontainsper-modelusage.typeModelUsagestruct{Requestsint`json:"requests"`Tokensint`json:"tokens"`Costfloat64`json:"cost"`}//JSONMapisagenericJSONobject.typeJSONMapmap[string]interface{}//============================================================//ChatCompletion//============================================================//Messagerepresentsachatmessage.typeMessagestruct{Rolestring`json:"role"`Contentinterface{}`json:"content"`Namestring`json:"name,omitempty"`ToolCalls[]ToolCall`json:"tool_calls,omitempty"`}//ToolCallrepresentsatoolusage.typeToolCallstruct{IDstring`json:"id"`Typestring`json:"type"`FunctionFunctionCall`json:"function"`}//FunctionCallrepresentsafunctioncall.typeFunctionCallstruct{Namestring`json:"name"`Argumentsstring`json:"arguments"`}//Toolrepresentsanavailabletool.typeToolstruct{Typestring`json:"type"`FunctionToolFunction`json:"function"`}//ToolFunctiondescribesatoolfunction.typeToolFunctionstruct{Namestring`json:"name"`Descriptionstring`json:"description,omitempty"`ParametersJSONMap`json:"parameters,omitempty"`}//CompletionRequestisachatcompletionrequest.typeCompletionRequeststruct{Modelstring`json:"model"`Messages[]Message`json:"messages"`MaxTokensint`json:"max_tokens,omitempty"`Temperaturefloat64`json:"temperature,omitempty"`TopPfloat64`json:"top_p,omitempty"`Stop[]string`json:"stop,omitempty"`Streambool`json:"stream,omitempty"`Tools[]Tool`json:"tools,omitempty"`ToolChoicestring`json:"tool_choice,omitempty"`FrequencyPenaltyfloat64`json:"frequency_penalty,omitempty"`PresencePenaltyfloat64`json:"presence_penalty,omitempty"`}//CompletionResponseisachatcompletionresponse.typeCompletionResponsestruct{IDstring`json:"id"`Objectstring`json:"object"`Createdint64`json:"created"`Modelstring`json:"model"`Choices[]Choice`json:"choices"`UsageUsage`json:"usage"`}//Choicerepresentsacompletionchoice.typeChoicestruct{Indexint`json:"index"`MessageMessage`json:"message"`FinishReasonstring`json:"finish_reason"`}//Usagecontainstokenusage.typeUsagestruct{PromptTokensint`json:"prompt_tokens"`CompletionTokensint`json:"completion_tokens"`TotalTokensint`json:"total_tokens"`}//============================================================//UserMethods//============================================================//GetCurrentUserreturnstheauthenticateduser.func(c*Client)GetCurrentUser(ctxcontext.Context)(*User,error){varuserUseriferr:=c.request(ctx,"GET","/v1/users/me",nil,&user);err!=nil{returnnil,err}return&user,nil}//GetUserreturnsauserbyID.func(c*Client)GetUser(ctxcontext.Context,idstring)(*User,error){varuserUseriferr:=c.request(ctx,"GET","/v1/users/"+id,nil,&user);err!=nil{returnnil,err}return&user,nil}//ListUsersreturnsallusers.func(c*Client)ListUsers(ctxcontext.Context,limit,offsetint)([]User,error){path:=fmt.Sprintf("/v1/users?limit=%d&offset=%d",limit,offset)varusers[]Useriferr:=c.request(ctx,"GET",path,nil,&users);err!=nil{returnnil,err}returnusers,nil}//============================================================//TeamMethods//============================================================//ListTeamsreturnsallteams.func(c*Client)ListTeams(ctxcontext.Context)([]Team,error){varteams[]Teamiferr:=c.request(ctx,"GET","/v1/teams",nil,&teams);err!=nil{returnnil,err}returnteams,nil}//GetTeamreturnsateambyID.func(c*Client)GetTeam(ctxcontext.Context,idstring)(*Team,error){varteamTeamiferr:=c.request(ctx,"GET","/v1/teams/"+id,nil,&team);err!=nil{returnnil,err}return&team,nil}//CreateTeamRequestistherequesttocreateateam.typeCreateTeamRequeststruct{Namestring`json:"name"`Descriptionstring`json:"description,omitempty"`}//CreateTeamcreatesanewteam.func(c*Client)CreateTeam(ctxcontext.Context,req*CreateTeamRequest)(*Team,error){varteamTeamiferr:=c.request(ctx,"POST","/v1/teams",req,&team);err!=nil{returnnil,err}return&team,nil}//============================================================//WalletMethods//============================================================//GetCurrentWalletreturnstheauthenticateduser'swallet.func(c*Client)GetCurrentWallet(ctxcontext.Context)(*Wallet,error){varwalletWalletiferr:=c.request(ctx,"GET","/v1/wallets/me",nil,&wallet);err!=nil{returnnil,err}return&wallet,nil}//GetWalletreturnsawalletbyID.func(c*Client)GetWallet(ctxcontext.Context,idstring)(*Wallet,error){varwalletWalletiferr:=c.request(ctx,"GET","/v1/wallets/"+id,nil,&wallet);err!=nil{returnnil,err}return&wallet,nil}//GetWalletTransactionsreturnswallettransactions.func(c*Client)GetWalletTransactions(ctxcontext.Context,walletIDstring,limit,offsetint)([]Transaction,error){path:=fmt.Sprintf("/v1/wallets/%s/transactions?limit=%d&offset=%d",walletID,limit,offset)vartransactions[]Transactioniferr:=c.request(ctx,"GET",path,nil,&transactions);err!=nil{returnnil,err}returntransactions,nil}//UpdateWalletRequestistherequesttoupdatewalletlimits.typeUpdateWalletRequeststruct{SoftLimitfloat64`json:"soft_limit,omitempty"`HardLimitfloat64`json:"hard_limit,omitempty"`}//UpdateWalletupdateswalletsettings.func(c*Client)UpdateWallet(ctxcontext.Context,idstring,req*UpdateWalletRequest)(*Wallet,error){varwalletWalletiferr:=c.request(ctx,"PATCH","/v1/wallets/"+id,req,&wallet);err!=nil{returnnil,err}return&wallet,nil}//============================================================//TransferMethods//============================================================//CreateTransferRequestistherequesttocreateatransfer.typeCreateTransferRequeststruct{ToWalletIDstring`json:"to_wallet_id"`Amountfloat64`json:"amount"`Reasonstring`json:"reason,omitempty"`RequireApprovalbool`json:"require_approval,omitempty"`}//CreateTransfercreatesacredittransfer.func(c*Client)CreateTransfer(ctxcontext.Context,req*CreateTransferRequest)(*Transfer,error){vartransferTransferiferr:=c.request(ctx,"POST","/v1/transfers",req,&transfer);err!=nil{returnnil,err}return&transfer,nil}//GetTransferreturnsatransferbyID.func(c*Client)GetTransfer(ctxcontext.Context,idstring)(*Transfer,error){vartransferTransferiferr:=c.request(ctx,"GET","/v1/transfers/"+id,nil,&transfer);err!=nil{returnnil,err}return&transfer,nil}//ListTransfersreturnstransfers.func(c*Client)ListTransfers(ctxcontext.Context,statusstring,limit,offsetint)([]Transfer,error){path:=fmt.Sprintf("/v1/transfers?limit=%d&offset=%d",limit,offset)ifstatus!=""{path+="&status="+url.QueryEscape(status)}vartransfers[]Transferiferr:=c.request(ctx,"GET",path,nil,&transfers);err!=nil{returnnil,err}returntransfers,nil}//ApproveTransferapprovesapendingtransfer.func(c*Client)ApproveTransfer(ctxcontext.Context,idstring)(*Transfer,error){vartransferTransferiferr:=c.request(ctx,"POST","/v1/transfers/"+id+"/approve",nil,&transfer);err!=nil{returnnil,err}return&transfer,nil}//RejectTransferrejectsapendingtransfer.func(c*Client)RejectTransfer(ctxcontext.Context,idstring,reasonstring)(*Transfer,error){body:=map[string]string{"reason":reason}vartransferTransferiferr:=c.request(ctx,"POST","/v1/transfers/"+id+"/reject",body,&transfer);err!=nil{returnnil,err}return&transfer,nil}//============================================================//APIKeyMethods//============================================================//ListAPIKeysreturnstheuser'sAPIkeys.func(c*Client)ListAPIKeys(ctxcontext.Context)([]APIKey,error){varkeys[]APIKeyiferr:=c.request(ctx,"GET","/v1/api-keys",nil,&keys);err!=nil{returnnil,err}returnkeys,nil}//CreateAPIKeyRequestistherequesttocreateanAPIkey.typeCreateAPIKeyRequeststruct{Namestring`json:"name"`Scopes[]string`json:"scopes,omitempty"`ExpiresAt*time.Time`json:"expires_at,omitempty"`}//CreateAPIKeycreatesanewAPIkey.func(c*Client)CreateAPIKey(ctxcontext.Context,req*CreateAPIKeyRequest)(*APIKeyWithSecret,error){varkeyAPIKeyWithSecretiferr:=c.request(ctx,"POST","/v1/api-keys",req,&key);err!=nil{returnnil,err}return&key,nil}//RevokeAPIKeyrevokesanAPIkey.func(c*Client)RevokeAPIKey(ctxcontext.Context,idstring)error{returnc.request(ctx,"DELETE","/v1/api-keys/"+id,nil,nil)}//============================================================//ProviderMethods//============================================================//ListProvidersreturnsavailableproviders.func(c*Client)ListProviders(ctxcontext.Context)([]Provider,error){varproviders[]Provideriferr:=c.request(ctx,"GET","/v1/providers",nil,&providers);err!=nil{returnnil,err}returnproviders,nil}//GetProviderreturnsaproviderbyID.func(c*Client)GetProvider(ctxcontext.Context,idstring)(*Provider,error){varproviderProvideriferr:=c.request(ctx,"GET","/v1/providers/"+id,nil,&provider);err!=nil{returnnil,err}return&provider,nil}//============================================================//PolicyMethods//============================================================//ListPoliciesreturnsgovernancepolicies.func(c*Client)ListPolicies(ctxcontext.Context)([]Policy,error){varpolicies[]Policyiferr:=c.request(ctx,"GET","/v1/policies",nil,&policies);err!=nil{returnnil,err}returnpolicies,nil}//GetPolicyreturnsapolicybyID.func(c*Client)GetPolicy(ctxcontext.Context,idstring)(*Policy,error){varpolicyPolicyiferr:=c.request(ctx,"GET","/v1/policies/"+id,nil,&policy);err!=nil{returnnil,err}return&policy,nil}//CreatePolicyRequestistherequesttocreateapolicy.typeCreatePolicyRequeststruct{Namestring`json:"name"`Descriptionstring`json:"description,omitempty"`Rules[]string`json:"rules"`Priorityint`json:"priority,omitempty"`Enabledbool`json:"enabled"`}//CreatePolicycreatesanewpolicy.func(c*Client)CreatePolicy(ctxcontext.Context,req*CreatePolicyRequest)(*Policy,error){varpolicyPolicyiferr:=c.request(ctx,"POST","/v1/policies",req,&policy);err!=nil{returnnil,err}return&policy,nil}//============================================================//ExperimentMethods//============================================================//ListExperimentsreturnsroutingexperiments.func(c*Client)ListExperiments(ctxcontext.Context)([]Experiment,error){varexperiments[]Experimentiferr:=c.request(ctx,"GET","/v1/experiments",nil,&experiments);err!=nil{returnnil,err}returnexperiments,nil}//GetExperimentreturnsanexperimentbyID.func(c*Client)GetExperiment(ctxcontext.Context,idstring)(*Experiment,error){varexperimentExperimentiferr:=c.request(ctx,"GET","/v1/experiments/"+id,nil,&experiment);err!=nil{returnnil,err}return&experiment,nil}//CreateExperimentRequestistherequesttocreateanexperiment.typeCreateExperimentRequeststruct{Namestring`json:"name"`Descriptionstring`json:"description,omitempty"`TrafficSplitmap[string]int`json:"traffic_split"`}//CreateExperimentcreatesanewexperiment.func(c*Client)CreateExperiment(ctxcontext.Context,req*CreateExperimentRequest)(*Experiment,error){varexperimentExperimentiferr:=c.request(ctx,"POST","/v1/experiments",req,&experiment);err!=nil{returnnil,err}return&experiment,nil}//StartExperimentstartsanexperiment.func(c*Client)StartExperiment(ctxcontext.Context,idstring)(*Experiment,error){varexperimentExperimentiferr:=c.request(ctx,"POST","/v1/experiments/"+id+"/start",nil,&experiment);err!=nil{returnnil,err}return&experiment,nil}//StopExperimentstopsanexperiment.func(c*Client)StopExperiment(ctxcontext.Context,idstring)(*Experiment,error){varexperimentExperimentiferr:=c.request(ctx,"POST","/v1/experiments/"+id+"/stop",nil,&experiment);err!=nil{returnnil,err}return&experiment,nil}//============================================================//AnalyticsMethods//============================================================//GetUsageReportreturnsusageanalytics.func(c*Client)GetUsageReport(ctxcontext.Context,startDate,endDatetime.Time)(*UsageReport,error){path:=fmt.Sprintf("/v1/analytics/usage?start_date=%s&end_date=%s",startDate.Format("2006-01-02"),endDate.Format("2006-01-02"),)varreportUsageReportiferr:=c.request(ctx,"GET",path,nil,&report);err!=nil{returnnil,err}return&report,nil}//GetCostBreakdownreturnscostbreakdownbydimension.typeCostBreakdownstruct{ByModelmap[string]float64`json:"by_model"`ByProvidermap[string]float64`json:"by_provider"`ByTeammap[string]float64`json:"by_team"`Totalfloat64`json:"total"`}//GetCostBreakdownreturnscostanalytics.func(c*Client)GetCostBreakdown(ctxcontext.Context,startDate,endDatetime.Time)(*CostBreakdown,error){path:=fmt.Sprintf("/v1/analytics/costs?start_date=%s&end_date=%s",startDate.Format("2006-01-02"),endDate.Format("2006-01-02"),)varbreakdownCostBreakdowniferr:=c.request(ctx,"GET",path,nil,&breakdown);err!=nil{returnnil,err}return&breakdown,nil}//============================================================//ChatCompletionMethods//============================================================//ChatCompletioncreatesachatcompletion.func(c*Client)ChatCompletion(ctxcontext.Context,req*CompletionRequest)(*CompletionResponse,error){varrespCompletionResponseiferr:=c.request(ctx,"POST","/v1/chat/completions",req,&resp);err!=nil{returnnil,err}return&resp,nil}//QuickChatsendsasimplemessageandreturnstheresponse.func(c*Client)QuickChat(ctxcontext.Context,model,promptstring)(string,error){req:=&CompletionRequest{Model:model,Messages:[]Message{{Role:"user",Content:prompt},},}resp,err:=c.ChatCompletion(ctx,req)iferr!=nil{return"",err}iflen(resp.Choices)==0{return"",fmt.Errorf("nochoicesinresponse")}content,ok:=resp.Choices[0].Message.Content.(string)if!ok{return"",fmt.Errorf("unexpectedcontenttype")}returncontent,nil}//============================================================//HealthCheck//============================================================//Healthrepresentsservicehealth.typeHealthstruct{Statusstring`json:"status"`Versionstring`json:"version"`Providersmap[string]string`json:"providers,omitempty"`}//HealthCheckchecksservicehealth.func(c*Client)HealthCheck(ctxcontext.Context)(*Health,error){varhealthHealthiferr:=c.request(ctx,"GET","/health",nil,&health);err!=nil{returnnil,err}return&health,nil}