packagehandlerimport("encoding/json""net/http")//writeErrorwritesastandardizederrorresponseinOpenAI-compatibleformat//withanactionablehintfromtheerrorcatalog.funcwriteError(whttp.ResponseWriter,statusint,errType,messagestring){code:=ErrorCode(errType)hint:=errorCatalog[code]w.Header().Set("Content-Type","application/json")w.WriteHeader(status)buf:=getBuf()deferputBuf(buf)resp:=struct{Errorstruct{Typestring`json:"type"`Messagestring`json:"message"`Hintstring`json:"hint,omitempty"`Codestring`json:"code,omitempty"`}`json:"error"`}{}resp.Error.Type=errTyperesp.Error.Message=messageresp.Error.Hint=hintresp.Error.Code=errTypeiferr:=json.NewEncoder(buf).Encode(resp);err==nil{_,_=w.Write(buf.Bytes())}}