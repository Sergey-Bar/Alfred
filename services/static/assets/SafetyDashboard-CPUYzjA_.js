import{j as e}from"./index-DmO1ypIk.js";import{r}from"./vendor-CoKE50sv.js";import{Q as o,d as b,r as N,T as m,q as g,m as h}from"./icons-UwgmH0ZI.js";const I=()=>{const[t,l]=r.useState(null),[u,d]=r.useState(!0),[i,p]=r.useState("7d"),[n,f]=r.useState("all");r.useEffect(()=>{y()},[i,n]);const y=async()=>{d(!0);try{const a=await(await fetch(`/api/v1/safety/stats?range=${i}&category=${n}`)).json();l(a)}catch(s){console.error("Failed to fetch safety stats:",s),l({totalIncidents:247,blockedRequests:189,redactedRequests:34,warnedRequests:24,trend:12,byCategory:{pii:{count:156,trend:8},secret:{count:58,trend:-15},injection:{count:28,trend:45},blocklist:{count:5,trend:0}},bySeverity:{critical:42,high:98,medium:67,low:40},recentIncidents:[{id:"1",timestamp:"2026-02-16T10:30:00Z",userId:"user_123",category:"pii",type:"ssn",severity:"high",action:"blocked"},{id:"2",timestamp:"2026-02-16T09:15:00Z",userId:"user_456",category:"secret",type:"openai_api_key",severity:"critical",action:"blocked"},{id:"3",timestamp:"2026-02-16T08:45:00Z",userId:"user_789",category:"injection",type:"ignore_instructions",severity:"high",action:"blocked"}],topUsers:[{userId:"user_123",userName:"Alice Chen",incidents:12},{userId:"user_456",userName:"Bob Smith",incidents:8},{userId:"user_789",userName:"Carol Lee",incidents:6}]})}finally{d(!1)}},j=s=>new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),c=s=>{switch(s){case"pii":return"text-purple-600 bg-purple-100";case"secret":return"text-red-600 bg-red-100";case"injection":return"text-orange-600 bg-orange-100";case"blocklist":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},x=s=>{switch(s){case"critical":return"text-red-600 bg-red-100";case"high":return"text-orange-600 bg-orange-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-blue-600 bg-blue-100";default:return"text-gray-600 bg-gray-100"}};return u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(o,{className:"w-8 h-8 text-blue-600"}),"Safety Dashboard"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Monitor safety violations and enforce security policies"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:i,onChange:s=>p(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"1d",children:"Last 24 hours"}),e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(b,{className:"w-4 h-4"}),"Configure Policies"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(N,{className:"w-6 h-6 text-blue-600"})}),t?.trend!==void 0&&e.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${t.trend>=0?"text-red-600":"text-green-600"}`,children:[t.trend>=0?e.jsx(m,{className:"w-4 h-4"}):e.jsx(g,{className:"w-4 h-4"}),Math.abs(t.trend),"%"]})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.totalIncidents||0}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Total Incidents"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(h,{className:"w-6 h-6 text-red-600"})})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.blockedRequests||0}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Blocked Requests"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(o,{className:"w-6 h-6 text-green-600"})})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.redactedRequests||0}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Auto-Redacted"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(h,{className:"w-6 h-6 text-yellow-600"})})}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t?.warnedRequests||0}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Warnings"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Violations by Category"}),e.jsx("div",{className:"space-y-3",children:Object.entries(t?.byCategory||{}).map(([s,a])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${c(s)}`,children:s.toUpperCase()}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a.count})]}),a.trend!==0&&e.jsxs("div",{className:`flex items-center gap-1 text-xs font-medium ${a.trend>0?"text-red-600":"text-green-600"}`,children:[a.trend>0?e.jsx(m,{className:"w-3 h-3"}):e.jsx(g,{className:"w-3 h-3"}),Math.abs(a.trend),"%"]})]},s))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Violations by Severity"}),e.jsx("div",{className:"space-y-3",children:Object.entries(t?.bySeverity||{}).map(([s,a])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x(s)}`,children:s.toUpperCase()}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a})]}),e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${s==="critical"?"bg-red-600":s==="high"?"bg-orange-600":s==="medium"?"bg-yellow-600":"bg-blue-600"}`,style:{width:`${a/t.totalIncidents*100}%`}})})]},s))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-8",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Incidents"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Severity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t?.recentIncidents?.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:j(s.timestamp)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.userId}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${c(s.category)}`,children:s.category})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:s.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${x(s.severity)}`,children:s.severity})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 capitalize",children:s.action})]},s.id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Users with Most Violations"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-3",children:t?.topUsers?.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-blue-100 text-blue-600 rounded-full text-xs font-bold",children:a+1}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.userName}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",s.userId,")"]})]}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.incidents," incidents"]})]},s.userId))})})]})]})};export{I as SafetyDashboard,I as default};
