import{a as y,j as e}from"./index-DmO1ypIk.js";import{r as a}from"./vendor-CoKE50sv.js";import{b as d,_ as f,h as g,t as v,K as N,Q as _,W as A,k as u}from"./icons-UwgmH0ZI.js";const b={"user.":u,"team.":u,"quota.":A,"security.":_,"key.":N};function w(o){for(const[r,c]of Object.entries(b))if(o.startsWith(r))return c;return d}const h=[{id:1,timestamp:"2026-02-15T14:32:00Z",actor:"admin@acme.com",action:"user.create",target_type:"user",target_id:"alice@acme.com",details:"Created user with 2000 credit quota"},{id:2,timestamp:"2026-02-15T14:28:00Z",actor:"admin@acme.com",action:"team.update_pool",target_type:"team",target_id:"Engineering",details:"Increased pool from 30000 to 50000 credits"},{id:3,timestamp:"2026-02-15T13:55:00Z",actor:"system",action:"security.injection_blocked",target_type:"request",target_id:"req-f82a",details:"Prompt injection detected and blocked"},{id:4,timestamp:"2026-02-15T13:22:00Z",actor:"bob@acme.com",action:"key.rotate",target_type:"api_key",target_id:"key-***89a2",details:"API key rotated for service account"},{id:5,timestamp:"2026-02-15T12:45:00Z",actor:"admin@acme.com",action:"quota.override",target_type:"user",target_id:"carol@acme.com",details:"Approved 5000 credit override for Q1 project"},{id:6,timestamp:"2026-02-15T11:30:00Z",actor:"system",action:"security.pii_detected",target_type:"request",target_id:"req-a3c1",details:"SSN detected in prompt content â€” request blocked"},{id:7,timestamp:"2026-02-15T10:15:00Z",actor:"admin@acme.com",action:"user.suspend",target_type:"user",target_id:"dave@acme.com",details:"Account suspended for policy violation"},{id:8,timestamp:"2026-02-15T09:00:00Z",actor:"system",action:"quota.soft_limit",target_type:"team",target_id:"Product",details:"Team Product reached 80% of pool allocation"}];function I(){const[o,r]=a.useState([]),[c,p]=a.useState(""),[n,x]=a.useState("all"),[S,l]=a.useState(!0),[T,k]=a.useState(null);a.useEffect(()=>{let t=!0;return l(!0),y.getAuditLogs(0,100).then(s=>{if(t){const i=Array.isArray(s)?s:s.items||s.logs||[];r(i.length>0?i:h),l(!1)}}).catch(s=>{t&&(console.warn("Failed to fetch audit logs, using demo data:",s.message),r(h),l(!1))}),()=>{t=!1}},[]);const m=o.filter(t=>{const s=c.toLowerCase(),i=t.action.toLowerCase().includes(s)||t.actor.toLowerCase().includes(s)||t.details.toLowerCase().includes(s),j=n==="all"||t.action.startsWith(n);return i&&j});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"page-header flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"w-6 h-6",style:{color:"var(--color-accent-600)"}}),"Audit Log"]}),e.jsx("p",{className:"subtitle",children:"Immutable record of all administrative actions and security events"})]}),e.jsxs("button",{className:"btn btn-secondary",children:[e.jsx(f,{className:"w-4 h-4 mr-2"})," Export"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1",style:{maxWidth:400},children:[e.jsx(g,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4",style:{color:"var(--color-primary-400)"}}),e.jsx("input",{type:"text",placeholder:"Search logs...",value:c,onChange:t=>p(t.target.value),className:"input pl-10"})]}),e.jsxs("select",{value:n,onChange:t=>x(t.target.value),className:"input",style:{width:"auto"},children:[e.jsx("option",{value:"all",children:"All Actions"}),e.jsx("option",{value:"user.",children:"User Actions"}),e.jsx("option",{value:"team.",children:"Team Actions"}),e.jsx("option",{value:"quota.",children:"Quota Actions"}),e.jsx("option",{value:"security.",children:"Security Events"}),e.jsx("option",{value:"key.",children:"API Key Actions"})]})]}),e.jsxs("div",{className:"card p-0 overflow-hidden",children:[e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Timestamp"}),e.jsx("th",{children:"Actor"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Target"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:m.map(t=>{const s=w(t.action);return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-3.5 h-3.5",style:{color:"var(--color-primary-400)"}}),e.jsx("span",{className:"text-xs font-mono",children:new Date(t.timestamp).toLocaleString()})]})}),e.jsx("td",{children:e.jsx("span",{className:`text-sm ${t.actor==="system"?"italic":""}`,children:t.actor})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s,{className:"w-4 h-4",style:{color:"var(--color-primary-400)"}}),e.jsx("code",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:"var(--color-primary-100)"},children:t.action})]})}),e.jsx("td",{children:e.jsxs("span",{className:"text-sm",children:[t.target_type,": ",t.target_id]})}),e.jsx("td",{children:e.jsx("span",{className:"text-sm",style:{color:"var(--color-primary-500)"},children:t.details})})]},t.id)})})]}),m.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsx(d,{className:"icon"}),e.jsx("h3",{children:"No audit entries found"}),e.jsx("p",{children:"Try adjusting your search or filter criteria."})]})]})]})}export{I as default};
