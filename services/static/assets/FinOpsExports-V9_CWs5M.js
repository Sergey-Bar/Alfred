import{a as x,j as e}from"./index-DmO1ypIk.js";import{r as o}from"./vendor-CoKE50sv.js";import{v as f,am as u,t as h,a0 as v,d as C,a4 as w,_ as E,p as k,a9 as S,x as R}from"./icons-UwgmH0ZI.js";const i=[{id:"snowflake",name:"Snowflake",icon:"â„ï¸",desc:"Push cost data to Snowflake warehouse"},{id:"csv",name:"CSV Export",icon:"ðŸ“Š",desc:"Download as CSV with cost center headers"},{id:"json",name:"JSON Export",icon:"{}",desc:"Structured JSON with full metadata"},{id:"parquet",name:"Parquet",icon:"ðŸ“¦",desc:"Columnar format for big data pipelines"},{id:"sap",name:"SAP/Oracle ERP",icon:"ðŸ¢",desc:"ERP-compatible format with cost centers"}],b=[{value:"daily",label:"Daily",desc:"Every day at specified time"},{value:"weekly",label:"Weekly",desc:"Every Monday"},{value:"monthly",label:"Monthly",desc:"First of each month"},{value:"manual",label:"Manual Only",desc:"Trigger manually"}],p=[{id:"exp-1",name:"Monthly Chargeback Report",type:"csv",schedule:"monthly",lastRun:"2026-02-01T08:00:00Z",status:"success",records:12450,costCenters:["ENG-001","ML-002","PROD-003"],enabled:!0},{id:"exp-2",name:"Snowflake Daily Sync",type:"snowflake",schedule:"daily",lastRun:"2026-02-18T06:00:00Z",status:"success",records:4820,costCenters:[],enabled:!0},{id:"exp-3",name:"SAP Quarterly Export",type:"sap",schedule:"manual",lastRun:"2026-01-01T09:00:00Z",status:"success",records:38200,costCenters:["FIN-010","ENG-001"],enabled:!1}];function P({onClose:l,onSave:r}){const[t,c]=o.useState({name:"",type:"csv",schedule:"monthly",costCenters:"",includeMetadata:!0,groupByTeam:!0,dateRange:"30d"});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:l,children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 max-h-[80vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"New Export Configuration"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Export Name *"}),e.jsx("input",{type:"text",className:"input w-full",placeholder:"e.g., Monthly Engineering Chargeback",value:t.name,onChange:a=>c({...t,name:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Export Format"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.map(a=>e.jsxs("button",{onClick:()=>c({...t,type:a.id}),className:`p-3 rounded-lg border-2 text-left text-sm ${t.type===a.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("span",{className:"text-lg",children:a.icon}),e.jsx("p",{className:"font-medium",children:a.name})]},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Schedule"}),e.jsx("select",{className:"input w-full",value:t.schedule,onChange:a=>c({...t,schedule:a.target.value}),children:b.map(a=>e.jsxs("option",{value:a.value,children:[a.label," â€” ",a.desc]},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cost Centers (comma-separated)"}),e.jsx("input",{type:"text",className:"input w-full",placeholder:"ENG-001, ML-002, PROD-003",value:t.costCenters,onChange:a=>c({...t,costCenters:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date Range"}),e.jsxs("select",{className:"input w-full",value:t.dateRange,onChange:a=>c({...t,dateRange:a.target.value}),children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"ytd",children:"Year to date"}),e.jsx("option",{value:"custom",children:"Custom range"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.includeMetadata,onChange:a=>c({...t,includeMetadata:a.target.checked}),className:"rounded text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Include request metadata (model, latency)"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.groupByTeam,onChange:a=>c({...t,groupByTeam:a.target.checked}),className:"rounded text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Group by team / cost center"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t",children:[e.jsx("button",{onClick:l,className:"btn",children:"Cancel"}),e.jsx("button",{onClick:()=>{r(t),l()},className:"btn btn-primary",disabled:!t.name,children:"Create Export"})]})]})})})}function M(){const[l,r]=o.useState([]),[t,c]=o.useState(!0),[a,m]=o.useState(!1);o.useEffect(()=>{j()},[]);const j=async()=>{c(!0);try{const s=await x.fetchJson("/finops/exports");r(Array.isArray(s)?s:p)}catch{r(p)}finally{c(!1)}},g=async s=>{try{await x.fetchJson(`/finops/exports/${s}/run`,{method:"POST"})}catch{}},y=s=>{r([...l,{id:`exp-${Date.now()}`,name:s.name,type:s.type,schedule:s.schedule,lastRun:null,status:"pending",records:0,costCenters:s.costCenters?s.costCenters.split(",").map(n=>n.trim()):[],enabled:!0}])},N=s=>i.find(n=>n.id===s)||i[0];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"FinOps Exports"}),e.jsx("p",{style:{color:"var(--color-primary-500)"},children:"Scheduled cost data exports and chargeback reports"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-primary flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"})," New Export"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Configured Exports",value:l.length,icon:u,color:"text-blue-600"},{label:"Active Schedules",value:l.filter(s=>s.enabled&&s.schedule!=="manual").length,icon:h,color:"text-green-600"},{label:"Total Records Exported",value:l.reduce((s,n)=>s+(n.records||0),0).toLocaleString(),icon:v,color:"text-purple-600"},{label:"Cost Centers Tracked",value:[...new Set(l.flatMap(s=>s.costCenters||[]))].length,icon:C,color:"text-orange-600"}].map(s=>e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(s.icon,{className:`w-4 h-4 ${s.color}`}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-primary-400)"},children:s.label})]}),e.jsx("p",{className:`text-2xl font-bold ${s.color}`,children:s.value})]},s.label))}),e.jsx("div",{className:"space-y-3",children:t?e.jsxs("div",{className:"text-center py-12 card",children:[e.jsx(w,{className:"w-8 h-8 animate-spin mx-auto mb-2",style:{color:"var(--color-primary-300)"}}),e.jsx("p",{style:{color:"var(--color-primary-400)"},children:"Loading exports..."})]}):l.length===0?e.jsxs("div",{className:"text-center py-12 card",children:[e.jsx(E,{className:"w-8 h-8 mx-auto mb-2",style:{color:"var(--color-primary-300)"}}),e.jsx("p",{style:{color:"var(--color-primary-400)"},children:"No exports configured yet"})]}):l.map(s=>{const n=N(s.type);return e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:n.icon}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsx("span",{className:`badge ${s.enabled?"badge-green":"badge-gray"} text-xs`,children:s.enabled?"Active":"Disabled"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs",style:{color:"var(--color-primary-400)"},children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"})," ",n.name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-3 h-3"}),b.find(d=>d.value===s.schedule)?.label||s.schedule]}),s.lastRun&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(h,{className:"w-3 h-3"})," Last: ",new Date(s.lastRun).toLocaleDateString()]}),e.jsxs("span",{children:[s.records?.toLocaleString()," records"]})]}),s.costCenters?.length>0&&e.jsx("div",{className:"flex gap-1 mt-2",children:s.costCenters.map(d=>e.jsx("span",{className:"badge badge-blue text-xs",children:d},d))})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>g(s.id),className:"btn btn-sm flex items-center gap-1",title:"Run now",children:[e.jsx(S,{className:"w-3 h-3"})," Run"]}),e.jsx("button",{className:"btn btn-sm",title:"Delete",children:e.jsx(R,{className:"w-3 h-3 text-red-500"})})]})]})},s.id)})}),a&&e.jsx(P,{onClose:()=>m(!1),onSave:y})]})}export{M as default};
