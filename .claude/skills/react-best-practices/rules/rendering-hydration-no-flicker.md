---title:PreventHydrationMismatchWithoutFlickeringimpact:MEDIUMimpactDescription:avoidsvisualflickerandhydrationerrorstags:rendering,ssr,hydration,localStorage,flicker---##PreventHydrationMismatchWithoutFlickeringWhenrenderingcontentthatdependsonclient-sidestorage(localStorage,cookies),avoidbothSSRbreakageandpost-hydrationflickeringbyinjectingasynchronousscriptthatupdatestheDOMbeforeReacthydrates.**Incorrect(breaksSSR):**```tsxfunctionThemeWrapper({children}:{children:ReactNode}){//localStorageisnotavailableonserver-throwserrorconsttheme=localStorage.getItem('theme')||'light'return(<divclassName={theme}>{children}</div>)}```Server-siderenderingwillfailbecause`localStorage`isundefined.**Incorrect(visualflickering):**```tsxfunctionThemeWrapper({children}:{children:ReactNode}){const[theme,setTheme]=useState('light')useEffect(()=>{//Runsafterhydration-causesvisibleflashconststored=localStorage.getItem('theme')if(stored){setTheme(stored)}},[])return(<divclassName={theme}>{children}</div>)}```Componentfirstrenderswithdefaultvalue(`light`),thenupdatesafterhydration,causingavisibleflashofincorrectcontent.**Correct(noflicker,nohydrationmismatch):**```tsxfunctionThemeWrapper({children}:{children:ReactNode}){return(<><divid="theme-wrapper">{children}</div><scriptdangerouslySetInnerHTML={{__html:`(function(){try{vartheme=localStorage.getItem('theme')||'light';varel=document.getElementById('theme-wrapper');if(el)el.className=theme;}catch(e){}})();`,}}/></>)}```Theinlinescriptexecutessynchronouslybeforeshowingtheelement,ensuringtheDOMalreadyhasthecorrectvalue.Noflickering,nohydrationmismatch.Thispatternisespeciallyusefulforthemetoggles,userpreferences,authenticationstates,andanyclient-onlydatathatshouldrenderimmediatelywithoutflashingdefaultvalues.