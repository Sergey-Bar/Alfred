import{i as E,f as T,e as u,j as e,c as v,d as w,k as $}from"./index-BYTAyHyu.js";import{r as t}from"./vendor-CoKE50sv.js";import{F as D}from"./PlusIcon-CvPvxy5e.js";import{F as M}from"./ClockIcon-DqX5lot2.js";function Z({title:x,titleId:a,...n},c){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":a},n),x?t.createElement("title",{id:a},x):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const P=t.forwardRef(Z);function J(){const{user:x}=E(),{showToast:a}=T(),[n,c]=t.useState([]),[k,b]=t.useState(!0),[q,R]=t.useState(null),[l,_]=t.useState("pending"),[A,d]=t.useState(!1),[r,h]=t.useState({amount:"",reason:""}),[f,p]=t.useState(!1),[y,o]=t.useState(null);t.useEffect(()=>{m()},[]);async function m(){try{b(!0);const s=await u.getPendingApprovals();c(s.approvals||s||[])}catch(s){R(s.message),c([{id:"1",user_name:"Alice Johnson",user_email:"alice@example.com",requested_amount:5e3,reason:"Large project deadline",status:"pending",created_at:"2026-02-12T10:30:00Z"},{id:"2",user_name:"Bob Smith",user_email:"bob@example.com",requested_amount:2e3,reason:"Need extra tokens for testing",status:"pending",created_at:"2026-02-11T14:15:00Z"},{id:"3",user_name:"Carol Williams",user_email:"carol@example.com",requested_amount:3e3,reason:"Research project",status:"approved",approved_amount:2500,created_at:"2026-02-10T09:00:00Z"},{id:"4",user_name:"David Brown",user_email:"david@example.com",requested_amount:1e3,reason:"Client demo",status:"rejected",rejection_reason:"Insufficient justification",created_at:"2026-02-09T16:45:00Z"}])}finally{b(!1)}}async function S(s){if(s.preventDefault(),!r.amount||!r.reason){a("Please enter amount and reason","error");return}try{p(!0),await u.createApprovalRequest(parseInt(r.amount),r.reason),a("Quota request submitted successfully","success"),d(!1),h({amount:"",reason:""}),m()}catch(i){a(i.message||"Failed to submit request","error")}finally{p(!1)}}async function C(s,i=null){try{o(s),await u.approveRequest(s,i),a("Request approved","success"),m()}catch(j){a(j.message||"Failed to approve request","error")}finally{o(null)}}async function F(s){const i=prompt("Reason for rejection (optional):");try{o(s),await u.rejectRequest(s,i||""),a("Request rejected","success"),m()}catch(j){a(j.message||"Failed to reject request","error")}finally{o(null)}}function L(s){return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}const N=n.filter(s=>l==="all"?!0:s.status===l),g={pending:n.filter(s=>s.status==="pending").length,approved:n.filter(s=>s.status==="approved").length,rejected:n.filter(s=>s.status==="rejected").length};return k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Quota Approvals"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Manage quota increase requests"})]}),e.jsxs("button",{onClick:()=>d(!0),className:"btn btn-primary flex items-center",children:[e.jsx(D,{className:"h-5 w-5 mr-2"}),"Request Quota"]})]}),q&&e.jsx("div",{className:"mb-4 p-3 bg-yellow-900/30 text-yellow-400 rounded-lg text-sm",children:"Using demo data - API connection issue"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-8 w-8 text-yellow-500 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"stat-value",children:g.pending}),e.jsx("p",{className:"stat-label",children:"Pending"})]})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-8 w-8 text-green-500 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"stat-value",children:g.approved}),e.jsx("p",{className:"stat-label",children:"Approved"})]})]})}),e.jsx("div",{className:"stat-card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"h-8 w-8 text-red-500 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"stat-value",children:g.rejected}),e.jsx("p",{className:"stat-label",children:"Rejected"})]})]})})]}),e.jsx("div",{className:"card mb-6",children:e.jsx("div",{className:"flex space-x-2",children:["pending","approved","rejected","all"].map(s=>e.jsx("button",{onClick:()=>_(s),className:`px-4 py-2 text-sm rounded-lg ${l===s?"bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-400 font-medium":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"space-y-4",children:[N.map(s=>e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mr-3",children:s.user_name}),e.jsx("span",{className:`badge ${s.status==="pending"?"badge-yellow":s.status==="approved"?"badge-green":"badge-red"}`,children:s.status})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:s.user_email}),e.jsxs("div",{className:"flex items-center text-sm mb-2",children:[e.jsx(P,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:s.reason})]}),e.jsx("p",{className:"text-xs text-gray-400",children:L(s.created_at)})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:[s.requested_amount?.toLocaleString()," tokens"]}),s.status==="approved"&&s.approved_amount&&e.jsxs("p",{className:"text-sm text-green-500",children:["Approved: ",s.approved_amount.toLocaleString()]}),s.status==="rejected"&&s.rejection_reason&&e.jsx("p",{className:"text-sm text-red-400",children:s.rejection_reason}),s.status==="pending"&&e.jsxs("div",{className:"flex space-x-2 mt-2",children:[e.jsxs("button",{onClick:()=>C(s.id,s.requested_amount),disabled:y===s.id,className:"btn btn-sm bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(v,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs("button",{onClick:()=>F(s.id),disabled:y===s.id,className:"btn btn-sm bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(w,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]})]})},s.id)),N.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:["No ",l==="all"?"":l," requests found"]})]})}),A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Request Additional Quota"}),e.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx($,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Amount Requested (tokens)"}),e.jsx("input",{type:"number",min:"1",value:r.amount,onChange:s=>h({...r,amount:s.target.value}),className:"input w-full",placeholder:"e.g., 5000",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Reason / Justification"}),e.jsx("textarea",{value:r.reason,onChange:s=>h({...r,reason:s.target.value}),className:"input w-full",rows:4,placeholder:"Explain why you need additional tokens...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f,children:f?"Submitting...":"Submit Request"})]})]})]})})]})}export{J as default};
